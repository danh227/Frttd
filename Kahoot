// ==UserScript==
// @name         Kahoot Highlight Partial Answer Match (No Auto Click)
// @namespace    http://tampermonkey.net/
// @version      1.1
// @description  Nháº¥p nhÃ¡y Ä‘Ã¡p Ã¡n Ä‘Ãºng náº¿u khá»›p má»™t pháº§n vá»›i danh sÃ¡ch, khÃ´ng tá»± Ä‘á»™ng chá»n âš¡ï¸ðŸ‡»ðŸ‡³
// @author       You
// @match        https://kahoot.it/*
// @grant        none
// ==/UserScript==

(function () {
    'use strict';

    const answerKeywords = [
        "oxi hÃ³a",         // vÃ­ dá»¥: sáº½ khá»›p vá»›i "Pháº£n á»©ng oxi hÃ³a táº¡o ra lá»­a"
        "nguá»“n nhiá»‡t",     // vÃ­ dá»¥: sáº½ khá»›p vá»›i "Cáº¯t nguá»“n nhiá»‡t"
        "khoáº£ng cÃ¡ch",     // khá»›p vá»›i "Khoáº£ng cÃ¡ch an toÃ n"
        // âž• ThÃªm tá»« khÃ³a/Ä‘oáº¡n ná»™i dung ngáº¯n Ä‘á»ƒ so sÃ¡nh táº¡i Ä‘Ã¢y
    ];

    const blinkStyle = `
        @keyframes blink {
            0% { background-color: yellow; }
            50% { background-color: red; }
            100% { background-color: yellow; }
        }
        .blinking {
            animation: blink 0.6s infinite;
        }
    `;

    const styleSheet = document.createElement("style");
    styleSheet.innerText = blinkStyle;
    document.head.appendChild(styleSheet);

    function normalize(text) {
        return text.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").trim();
    }

    function highlightMatchingAnswers() {
        const answerEls = document.querySelectorAll('[data-functional-selector="answer-text"]');

        answerEls.forEach(el => {
            const answerText = normalize(el.textContent);
            for (const keyword of answerKeywords) {
                if (answerText.includes(normalize(keyword))) {
                    const btn = el.closest('button');
                    if (btn && !btn.classList.contains('blinking')) {
                        btn.classList.add('blinking');
                    }
                    break;
                }
            }
        });

        requestAnimationFrame(highlightMatchingAnswers);
    }

    requestAnimationFrame(highlightMatchingAnswers);
})();